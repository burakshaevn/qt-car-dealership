# Тесты для системы обслуживания клиентов

Этот набор тестов покрывает все аспекты системы обслуживания клиентов в автосалоне Mercedes-Benz.

## Структура тестов

### 1. ClientServiceTests.cpp
Тесты для всех видов обслуживания клиента:
- **Заявки на обслуживание** - создание, обновление статуса
- **Заявки на страхование** - создание, одобрение, отклонение
- **Заявки на кредит** - создание, обработка
- **Заявки на тест-драйв** - создание и управление
- **Заявки на аренду** - создание и обработка
- **Заявки на покупку** - создание и управление
- **Заявки на заказ** - создание кастомных заказов
- **Уведомления** - создание, фильтрация, скрытие
- **Комплексные сценарии** - полный цикл обслуживания клиента

### 2. UITests.cpp
Тесты пользовательского интерфейса:
- **Загрузка уведомлений** - корректное отображение
- **Создание виджетов** - правильное создание UI элементов
- **Фильтрация** - работа ComboBox для фильтров
- **Сортировка** - работа кнопки сортировки
- **Кнопки управления** - "Прочитать все", "Удалить старые"
- **Стили и внешний вид** - проверка CSS стилей
- **Обработка ошибок** - корректная обработка ошибок БД
- **Производительность UI** - время загрузки при большом количестве уведомлений
- **Доступность** - accessibility функции

### 3. IntegrationTests.cpp
Интеграционные тесты:
- **Полный цикл обслуживания** - от тест-драйва до покупки
- **Фильтрация уведомлений** - работа всех фильтров
- **Сортировка уведомлений** - правильная сортировка по дате
- **Управление уведомлениями** - чтение, скрытие, удаление
- **Генерация договоров** - создание договоров для одобренных заявок
- **Обработка ошибок** - корректная обработка ошибок БД
- **Производительность** - время выполнения операций
- **Целостность данных** - корректность сохранения данных
- **Транзакции** - правильная работа с транзакциями БД

## Запуск тестов

### Windows
```bash
run_tests.bat
```

### Linux/macOS
```bash
mkdir build
cd build
cmake ..
make
ctest --output-on-failure
```

## Покрытие тестами

### Функциональное покрытие
- ✅ Создание всех типов заявок
- ✅ Обновление статусов заявок
- ✅ Управление уведомлениями
- ✅ Фильтрация и сортировка
- ✅ Генерация договоров
- ✅ Обработка ошибок

### Покрытие компонентов
- ✅ DatabaseHandler - работа с БД
- ✅ NotificationsHandler - управление уведомлениями
- ✅ ContractTemplates - генерация договоров
- ✅ UI компоненты - интерфейс пользователя

### Покрытие сценариев
- ✅ Новый клиент - полный цикл от знакомства до покупки
- ✅ Существующий клиент - дополнительные услуги
- ✅ Обработка ошибок - некорректные данные, проблемы с БД
- ✅ Производительность - большое количество данных

## Требования

- Google Test Framework
- Qt 5/6 (Core, Widgets, Sql, Test)
- CMake 3.16+
- C++20 компилятор

## Настройка

1. Убедитесь, что установлены все зависимости
2. Настройте переменные окружения для Qt
3. Запустите тесты через CMake/CTest

## Добавление новых тестов

1. Создайте новый файл тестов в директории `tests/`
2. Добавьте файл в `CMakeLists.txt`
3. Следуйте существующим паттернам тестирования
4. Обновите документацию

## Отладка тестов

Для отладки конкретного теста:
```bash
# Запуск конкретного теста
./client_service_tests --gtest_filter="ClientServiceTest.ServiceRequestCreation"

# Запуск с подробным выводом
./client_service_tests --gtest_filter="*" --gtest_output=xml
```

## Метрики качества

- **Покрытие кода**: >90%
- **Время выполнения**: <5 секунд для всех тестов
- **Успешность**: 100% тестов должны проходить
- **Повторяемость**: Тесты должны быть детерминированными
